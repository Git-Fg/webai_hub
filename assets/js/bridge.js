(function(){"use strict";const E=["input-area","textarea[placeholder*='Prompt']","textarea[aria-label*='prompt'], textarea[aria-label*='Prompt']",".ql-editor","div[contenteditable='true']","textarea"],T=['send-button[variant="primary"]','button[aria-label*="Send"], button[aria-label*="send"]','button mat-icon:contains("send")',".send-button button",'button[type="submit"]','button:contains("Send")'],m=["response-container",".response-message",".message-response",".markdown",".response-content","[data-testid*='response']",".message-content"],w=['mat-icon[data-mat-icon-name="stop"]',".generating-indicator",".loading-indicator","[data-testid*='generating']",".spinner",".loading-spinner",".thinking-indicator"];function u(e,t=1e4){return new Promise((i,n)=>{let a=0;const r=setInterval(()=>{for(const l of e){const s=document.querySelector(l);if(s){clearInterval(r),i(s);return}}a+=300,a>=t&&(clearInterval(r),n(new Error(`None of the selectors [${e.join(", ")}] found within ${t}ms`)))},300)})}function c(e){const t=window;t.flutter_inappwebview&&t.flutter_inappwebview.callHandler("automationBridge",e)}function p(){return{documentReadyState:document.readyState,hasFlutterBridge:!!window.flutter_inappwebview,hasStartAutomation:typeof window.startAutomation<"u",hasExtractFinalResponse:typeof window.extractFinalResponse<"u",url:window.location.href,timestamp:new Date().toISOString()}}async function b(e){try{const t=await u(E);if(t.tagName==="TEXTAREA"||t.tagName==="INPUT"){const n=t;n.value=e,t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0}))}else if(t instanceof HTMLElement&&t.contentEditable==="true"){const n=t;n.innerText=e,t.dispatchEvent(new Event("input",{bubbles:!0}))}else{const n=t;n.click(),await new Promise(a=>setTimeout(()=>a(),500));const o=n;o.value!==void 0&&(o.value=e)}(await u(T)).click(),await u(w,5e3),await new Promise(n=>{const o=w[0];if(!o){n();return}const a=new MutationObserver((l,s)=>{document.querySelector(o)||(c({type:"GENERATION_COMPLETE"}),s.disconnect(),clearTimeout(r),n())});a.observe(document.body,{childList:!0,subtree:!0});const r=setTimeout(()=>{a.disconnect(),c({type:"GENERATION_COMPLETE"}),n()},45e3)})}catch(t){const i=t instanceof Error?t.message:String(t),n={...p(),promptLength:e.length,promptPreview:e.length>50?e.substring(0,50)+"...":e};throw t instanceof Error&&t.message.includes("not found within")&&(n.errorType="ELEMENT_NOT_FOUND",n.timeoutReached=!0),c({type:"AUTOMATION_FAILED",payload:i,errorCode:"AUTOMATION_EXECUTION_FAILED",location:"startAutomation",diagnostics:n}),t}}async function g(){try{let e=[];for(const n of m){const o=Array.from(document.querySelectorAll(n));e.push(...o)}if(e.length===0&&(e=Array.from(document.querySelectorAll("*")).filter(o=>{const r=(o.innerText?.trim()||"").length>50,l=!o.matches("input, textarea, button, select, option"),s=o.offsetParent!==null;return r&&l&&s})),e.length===0)return(document.body?.innerText||"").trim()||"No response available";const t=e[e.length-1];return t?t.innerText?.trim()||"":"No last response element found, though the array was not empty."}catch(e){const t=e instanceof Error?e.message:String(e),i={...p(),responseContainerSelectors:m.length,foundResponseElements:0};throw c({type:"AUTOMATION_FAILED",payload:t,errorCode:"RESPONSE_EXTRACTION_FAILED",location:"extractFinalResponse",diagnostics:i}),e}}function h(){const e=window;if(e.flutter_inappwebview)try{e.flutter_inappwebview.callHandler("bridgeReady")}catch(t){console.warn("Failed to signal bridge ready:",t)}}function d(e=10,t=200){if(e<=0)return;window.flutter_inappwebview?h():setTimeout(()=>d(e-1,t),t)}const f=window;f.startAutomation=b,f.extractFinalResponse=g,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{d()}):d()})();
